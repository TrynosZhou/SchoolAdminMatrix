<!-- Demo Account Banner -->
<div class="demo-banner" *ngIf="isAuthenticated() && isDemoUser()">
  <div class="demo-banner-content">
    <span class="demo-icon">âš ï¸</span>
    <span class="demo-text">
      <strong>You are using the Demo School account.</strong> Some actions like changing settings, password, or school name are disabled. Demo data is reset every night.
    </span>
  </div>
</div>

<!-- Responsive Navigation -->
<nav class="navbar" *ngIf="isAuthenticated()">
  <div class="nav-container">
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" 
            (click)="toggleMobileMenu()" 
            aria-label="Toggle menu"
            *ngIf="isAuthenticated()">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="3" y1="12" x2="21" y2="12" *ngIf="!mobileMenuOpen"></line>
        <line x1="3" y1="6" x2="21" y2="6" *ngIf="!mobileMenuOpen"></line>
        <line x1="3" y1="18" x2="21" y2="18" *ngIf="!mobileMenuOpen"></line>
        <line x1="18" y1="6" x2="6" y2="18" *ngIf="mobileMenuOpen"></line>
        <line x1="6" y1="6" x2="18" y2="18" *ngIf="mobileMenuOpen"></line>
      </svg>
    </button>

    <!-- School Name / Logo -->
    <div class="nav-brand">
      <h1 class="nav-title">{{ schoolName }}</h1>
    </div>

    <!-- Desktop Navigation Links -->
    <div class="nav-links desktop-only" *ngIf="isAuthenticated()">
      <!-- Admin/Teacher Navigation -->
      <ng-container *ngIf="!isParent()">
        <a routerLink="/dashboard" routerLinkActive="active" class="nav-link">
          <span class="nav-icon">ğŸ </span>
          <span>Dashboard</span>
        </a>
        <a routerLink="/students" routerLinkActive="active" class="nav-link">
          <span class="nav-icon">ğŸ‘¨â€ğŸ“</span>
          <span>Students</span>
        </a>
        <a routerLink="/teachers" routerLinkActive="active" class="nav-link">
          <span class="nav-icon">ğŸ‘¨â€ğŸ«</span>
          <span>Teachers</span>
        </a>
        <a routerLink="/teacher/record-book" routerLinkActive="active" class="nav-link" *ngIf="isTeacher()">
          <span class="nav-icon">ğŸ“š</span>
          <span>My Record Book</span>
        </a>
        <a routerLink="/exams" routerLinkActive="active" class="nav-link">
          <span class="nav-icon">ğŸ“</span>
          <span>Exams</span>
        </a>
        <a routerLink="/report-cards" routerLinkActive="active" class="nav-link">
          <span class="nav-icon">ğŸ“Š</span>
          <span>Reports</span>
        </a>
        <a routerLink="/rankings" routerLinkActive="active" class="nav-link" *ngIf="canAccessModule('rankings')">
          <span class="nav-icon">ğŸ†</span>
          <span>Rankings</span>
        </a>
        <a routerLink="/invoices" routerLinkActive="active" class="nav-link" *ngIf="canAccessModule('finance')">
          <span class="nav-icon">ğŸ’°</span>
          <span>Finance</span>
        </a>
      </ng-container>
      
      <!-- Parent Navigation -->
      <ng-container *ngIf="isParent()">
        <a routerLink="/parent/dashboard" routerLinkActive="active" class="nav-link">
          <span class="nav-icon">ğŸ </span>
          <span>Parent Dashboard</span>
        </a>
      </ng-container>
    </div>

    <!-- Desktop Logout Button -->
    <button class="btn btn-secondary desktop-only" (click)="logout()" *ngIf="isAuthenticated()">
      <span>Logout</span>
    </button>
  </div>
</nav>

<!-- Mobile Sidebar Menu -->
<div class="mobile-sidebar" 
     [class.open]="mobileMenuOpen" 
     *ngIf="isAuthenticated()">
  <!-- Overlay -->
  <div class="mobile-sidebar-overlay" 
       (click)="closeMobileMenu()"
       [class.show]="mobileMenuOpen"></div>
  
  <!-- Sidebar Content -->
  <div class="mobile-sidebar-content" [class.show]="mobileMenuOpen">
    <div class="mobile-sidebar-header">
      <h2>{{ schoolName }}</h2>
      <button class="mobile-sidebar-close" 
              (click)="closeMobileMenu()" 
              aria-label="Close menu">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>

    <nav class="mobile-nav-links">
      <!-- Admin/Teacher Navigation -->
      <ng-container *ngIf="!isParent()">
        <a routerLink="/dashboard" 
           routerLinkActive="active" 
           class="mobile-nav-link"
           (click)="closeMobileMenu()">
          <span class="nav-icon">ğŸ </span>
          <span>Dashboard</span>
        </a>
        <a routerLink="/students" 
           routerLinkActive="active" 
           class="mobile-nav-link"
           (click)="closeMobileMenu()">
          <span class="nav-icon">ğŸ‘¨â€ğŸ“</span>
          <span>Students</span>
        </a>
        <a routerLink="/teachers" 
           routerLinkActive="active" 
           class="mobile-nav-link"
           (click)="closeMobileMenu()">
          <span class="nav-icon">ğŸ‘¨â€ğŸ«</span>
          <span>Teachers</span>
        </a>
        <a routerLink="/teacher/record-book" 
           routerLinkActive="active" 
           class="mobile-nav-link"
           *ngIf="isTeacher()"
           (click)="closeMobileMenu()">
          <span class="nav-icon">ğŸ“š</span>
          <span>My Record Book</span>
        </a>
        <a routerLink="/exams" 
           routerLinkActive="active" 
           class="mobile-nav-link"
           (click)="closeMobileMenu()">
          <span class="nav-icon">ğŸ“</span>
          <span>Exams</span>
        </a>
        <a routerLink="/report-cards" 
           routerLinkActive="active" 
           class="mobile-nav-link"
           (click)="closeMobileMenu()">
          <span class="nav-icon">ğŸ“Š</span>
          <span>Report Cards</span>
        </a>
        <a routerLink="/rankings" 
           routerLinkActive="active" 
           class="mobile-nav-link"
           (click)="closeMobileMenu()"
           *ngIf="canAccessModule('rankings')">
          <span class="nav-icon">ğŸ†</span>
          <span>Rankings</span>
        </a>
        <a routerLink="/invoices" 
           routerLinkActive="active" 
           class="mobile-nav-link"
           (click)="closeMobileMenu()"
           *ngIf="canAccessModule('finance')">
          <span class="nav-icon">ğŸ’°</span>
          <span>Finance</span>
        </a>
      </ng-container>
      
      <!-- Parent Navigation -->
      <ng-container *ngIf="isParent()">
        <a routerLink="/parent/dashboard" 
           routerLinkActive="active" 
           class="mobile-nav-link"
           (click)="closeMobileMenu()">
          <span class="nav-icon">ğŸ </span>
          <span>Parent Dashboard</span>
        </a>
      </ng-container>
    </nav>

    <!-- Mobile Logout Button -->
    <div class="mobile-sidebar-footer">
      <button class="btn btn-danger btn-block" (click)="logout()">
        <span>ğŸšª</span>
        <span>Logout</span>
      </button>
    </div>
  </div>
</div>

<!-- Main Content -->
<main class="main-content" [class.menu-open]="mobileMenuOpen">
  <router-outlet></router-outlet>
</main>

