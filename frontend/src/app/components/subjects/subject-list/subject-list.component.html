<div class="subjects-container">
  <!-- Header Section -->
  <div class="page-header">
    <div class="header-content">
      <div class="header-title">
        <h1>ğŸ“– Subject Management</h1>
        <p class="subtitle">Manage and organize all subjects in your school</p>
      </div>
      <button class="btn btn-primary btn-add" routerLink="/subjects/new">
        <span class="btn-icon">â•</span>
        <span>Add New Subject</span>
      </button>
    </div>
  </div>

  <!-- Alert Messages -->
  <div class="alert alert-success" *ngIf="success" (click)="success = ''">
    <span class="alert-icon">âœ…</span>
    <span>{{ success }}</span>
    <button class="alert-close" aria-label="Close">Ã—</button>
  </div>
  <div class="alert alert-error" *ngIf="error" (click)="error = ''">
    <span class="alert-icon">âš ï¸</span>
    <span>{{ error }}</span>
    <button class="alert-close" aria-label="Close">Ã—</button>
  </div>

  <!-- Filters and Search Section -->
  <div class="filters-section">
    <div class="search-box">
      <span class="search-icon">ğŸ”</span>
      <input 
        type="text" 
        class="search-input" 
        placeholder="Search subjects by code, name, or description..."
        [(ngModel)]="searchTerm"
        (input)="filterSubjects()">
      <button class="search-clear" *ngIf="searchTerm" (click)="clearSearch()" aria-label="Clear search">Ã—</button>
    </div>
    <div class="filter-controls">
      <select class="filter-select" [(ngModel)]="statusFilter" (change)="filterSubjects()">
        <option value="all">All Status</option>
        <option value="active">Active Only</option>
        <option value="inactive">Inactive Only</option>
      </select>
      <select class="filter-select" [(ngModel)]="sortBy" (change)="sortSubjects()">
        <option value="code">Sort by Code</option>
        <option value="name">Sort by Name</option>
        <option value="teachers">Sort by Teachers</option>
        <option value="classes">Sort by Classes</option>
      </select>
      <button class="btn btn-secondary btn-refresh" (click)="loadSubjects()" [disabled]="loading">
        <span class="btn-icon">ğŸ”„</span>
        <span>Refresh</span>
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="loading">
    <div class="skeleton-loader" *ngFor="let i of [1,2,3,4,5]">
      <div class="skeleton-row">
        <div class="skeleton-cell skeleton-code"></div>
        <div class="skeleton-cell skeleton-name"></div>
        <div class="skeleton-cell skeleton-count"></div>
        <div class="skeleton-cell skeleton-count"></div>
        <div class="skeleton-cell skeleton-status"></div>
        <div class="skeleton-cell skeleton-actions"></div>
      </div>
    </div>
  </div>

  <!-- Subjects Table -->
  <div class="table-container" *ngIf="!loading">
    <table class="modern-table">
      <thead>
        <tr>
          <th (click)="sortByColumn('code')" class="sortable">
            <span>Subject Code</span>
            <span class="sort-icon" *ngIf="sortColumn === 'code'">{{ sortDirection === 'asc' ? 'â†‘' : 'â†“' }}</span>
          </th>
          <th (click)="sortByColumn('name')" class="sortable">
            <span>Subject Name</span>
            <span class="sort-icon" *ngIf="sortColumn === 'name'">{{ sortDirection === 'asc' ? 'â†‘' : 'â†“' }}</span>
          </th>
          <th (click)="sortByColumn('teachers')" class="sortable">
            <span>Teachers</span>
            <span class="sort-icon" *ngIf="sortColumn === 'teachers'">{{ sortDirection === 'asc' ? 'â†‘' : 'â†“' }}</span>
          </th>
          <th (click)="sortByColumn('classes')" class="sortable">
            <span>Classes</span>
            <span class="sort-icon" *ngIf="sortColumn === 'classes'">{{ sortDirection === 'asc' ? 'â†‘' : 'â†“' }}</span>
          </th>
          <th>Status</th>
          <th class="actions-header"></th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let subject of filteredSubjects" class="table-row">
          <td class="subject-code">
            <span class="code-badge">{{ subject.code || 'N/A' }}</span>
          </td>
          <td class="subject-name">
            <span class="name-text">{{ subject.name }}</span>
          </td>
          <td class="subject-count">
            <span class="count-badge teachers">
              <span class="count-icon">ğŸ‘¨â€ğŸ«</span>
              {{ subject.teachers?.length || 0 }}
            </span>
          </td>
          <td class="subject-count">
            <span class="count-badge classes">
              <span class="count-icon">ğŸ«</span>
              {{ subject.classes?.length || 0 }}
            </span>
          </td>
          <td class="status-cell">
            <span class="status-badge" [class.active]="subject.isActive" [class.inactive]="!subject.isActive">
              <span class="status-dot"></span>
              {{ subject.isActive ? 'Active' : 'Inactive' }}
            </span>
          </td>
          <td class="actions-cell">
            <div class="action-buttons">
              <button 
                class="btn-action btn-edit" 
                (click)="editSubject(subject.id)" 
                title="Edit Subject">
                <span class="action-icon">âœï¸</span>
                <span class="action-text">Edit</span>
              </button>
              <span class="actions-label">Actions</span>
              <button 
                class="btn-action btn-delete" 
                (click)="deleteSubject(subject.id, subject.name, subject.code)" 
                [disabled]="loading"
                title="Delete Subject">
                <span class="action-icon">ğŸ—‘ï¸</span>
                <span class="action-text">Delete</span>
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- Empty State -->
    <div class="empty-state" *ngIf="filteredSubjects.length === 0 && !loading">
      <div class="empty-icon">ğŸ“–</div>
      <h3>{{ searchTerm || statusFilter !== 'all' ? 'No subjects found' : 'No subjects yet' }}</h3>
      <p *ngIf="searchTerm || statusFilter !== 'all'">
        Try adjusting your search or filter criteria.
      </p>
      <p *ngIf="!searchTerm && statusFilter === 'all'">
        Get started by creating your first subject.
      </p>
      <button class="btn btn-primary" routerLink="/subjects/new" *ngIf="!searchTerm && statusFilter === 'all'">
        <span class="btn-icon">â•</span>
        <span>Add Your First Subject</span>
      </button>
      <button class="btn btn-secondary" (click)="clearFilters()" *ngIf="searchTerm || statusFilter !== 'all'">
        <span>Clear Filters</span>
      </button>
    </div>

    <!-- Results Summary -->
    <div class="results-summary" *ngIf="filteredSubjects.length > 0">
      <span class="summary-text">
        Showing {{ filteredSubjects.length }} of {{ subjects.length }} subject{{ subjects.length !== 1 ? 's' : '' }}
      </span>
    </div>
  </div>
</div>

