<div class="container">
  <div class="enrollment-form-wrapper">
    <!-- Header Section -->
    <div class="form-header">
      <div class="header-content">
        <h1>
          <span class="icon">ğŸ“š</span>
          Enroll Student
        </h1>
        <p class="subtitle">Enroll a registered student into a class</p>
      </div>
      <button class="btn btn-icon" type="button" (click)="router.navigate(['/enrollments/unenrolled'])" title="Back to Unenrolled Students">
        â† Back
      </button>
    </div>

    <!-- Alert Messages -->
    <div class="alert alert-success" *ngIf="success">
      <span class="alert-icon">âœ“</span>
      <span>{{ success }}</span>
    </div>
    <div class="alert alert-error" *ngIf="error">
      <span class="alert-icon">âœ•</span>
      <span>{{ error }}</span>
    </div>

    <!-- Form Container -->
    <div class="form-container">
      <form (ngSubmit)="onSubmit()" #enrollmentForm="ngForm">
        <!-- Student Selection Section -->
        <div class="form-section">
          <div class="section-header">
            <h2>
              <span class="section-icon">ğŸ‘¤</span>
              Select Student
            </h2>
            <p class="section-description">Choose a registered student to enroll</p>
          </div>

          <div class="form-group">
            <label for="studentSearch">Search Student <span class="required">*</span></label>
            <div class="search-box">
              <input 
                type="text" 
                id="studentSearch"
                [(ngModel)]="searchQuery" 
                name="studentSearch"
                placeholder="Search by name or student number..."
                class="search-input"
                (input)="filterStudents()">
              <span class="search-icon">ğŸ”</span>
            </div>
          </div>

          <div class="form-group" *ngIf="filteredStudents.length > 0">
            <label>Select Student</label>
            <div class="student-list">
              <div 
                *ngFor="let student of filteredStudents" 
                class="student-item"
                [class.selected]="enrollment.studentId === student.id"
                (click)="enrollment.studentId = student.id; onStudentSelect()">
                <div class="student-info">
                  <strong>{{ student.firstName }} {{ student.lastName }}</strong>
                  <span class="student-number">{{ student.studentNumber }}</span>
                  <span class="student-type">{{ student.studentType }}</span>
                </div>
                <span class="check-icon" *ngIf="enrollment.studentId === student.id">âœ“</span>
              </div>
            </div>
          </div>

          <div class="info-box" *ngIf="selectedStudent">
            <div class="info-content">
              <span class="info-icon">â„¹ï¸</span>
              <div>
                <strong>Selected Student Information</strong>
                <p><strong>Name:</strong> {{ selectedStudent.firstName }} {{ selectedStudent.lastName }}</p>
                <p><strong>Student Number:</strong> {{ selectedStudent.studentNumber }}</p>
                <p><strong>Type:</strong> {{ selectedStudent.studentType }}</p>
                <p><strong>Status:</strong> <span class="status-badge not-enrolled">Not Enrolled</span></p>
              </div>
            </div>
          </div>
        </div>

        <!-- Class Selection Section -->
        <div class="form-section">
          <div class="section-header">
            <h2>
              <span class="section-icon">ğŸ«</span>
              Select Class
            </h2>
            <p class="section-description">Choose the class to enroll the student into</p>
          </div>

          <div class="form-group">
            <label for="classId">Class <span class="required">*</span></label>
            <select 
              id="classId"
              [(ngModel)]="enrollment.classId" 
              name="classId"
              required
              class="form-select">
              <option value="">Select class...</option>
              <option 
                *ngFor="let cls of classes" 
                [value]="cls.id">
                {{ cls.name }}
              </option>
            </select>
            <small class="form-hint">Select the class the student will be enrolled into</small>
          </div>
        </div>

        <!-- Enrollment Details Section -->
        <div class="form-section">
          <div class="section-header">
            <h2>
              <span class="section-icon">ğŸ“</span>
              Enrollment Details
            </h2>
            <p class="section-description">Additional information about the enrollment</p>
          </div>

          <div class="form-group">
            <label for="enrollmentDate">Enrollment Date <span class="required">*</span></label>
            <input 
              type="date" 
              id="enrollmentDate"
              [(ngModel)]="enrollment.enrollmentDate" 
              name="enrollmentDate"
              required
              class="form-input"
              [max]="maxDate">
            <small class="form-hint">Date when the student will be enrolled</small>
          </div>

          <div class="form-group">
            <label for="notes">Notes</label>
            <textarea 
              id="notes"
              [(ngModel)]="enrollment.notes" 
              name="notes"
              placeholder="Any additional notes (optional)"
              class="form-input"
              rows="3"
              maxlength="500"></textarea>
            <small class="form-hint">Optional: Add any additional information</small>
          </div>
        </div>

        <!-- Form Actions -->
        <div class="form-actions">
          <button 
            type="button" 
            class="btn btn-secondary" 
            (click)="router.navigate(['/enrollments/unenrolled'])"
            [disabled]="submitting">
            âŒ Cancel
          </button>
          <button 
            type="submit" 
            class="btn btn-primary btn-submit"
            [disabled]="submitting || !enrollment.studentId || !enrollment.classId">
            <span *ngIf="!submitting">
              âœ… Enroll Student
            </span>
            <span *ngIf="submitting" class="submit-loading">
              <span class="spinner-small"></span>
              Enrolling...
            </span>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

