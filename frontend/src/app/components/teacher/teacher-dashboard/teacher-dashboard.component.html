<div class="teacher-dashboard-container" [class.sidebar-collapsed]="sidebarCollapsed">
  <!-- Top Navigation Bar -->
  <nav class="top-navbar">
    <div class="top-navbar-content">
      <button class="sidebar-toggle" (click)="toggleSidebar()" aria-label="Toggle sidebar">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </button>
      <div class="navbar-title-section">
        <h1 class="top-navbar-title">{{ schoolName }}</h1>
        <p class="teacher-name-display" *ngIf="teacherName && teacherName !== 'Teacher'">{{ teacherName }}</p>
      </div>
      <button class="btn btn-secondary logout-btn" (click)="logout()">
        <span>Logout</span>
      </button>
    </div>
  </nav>

  <!-- Sidebar -->
  <aside class="sidebar" [class.collapsed]="sidebarCollapsed">
    <div class="sidebar-header">
      <h2>Teacher Portal</h2>
      <p class="user-info" *ngIf="teacherName && teacherName !== 'Teacher'">{{ teacherName }}</p>
      <p class="user-info" *ngIf="!teacherName || teacherName === 'Teacher'">Loading...</p>
    </div>
    
    <nav class="sidebar-nav">
      <!-- Dashboard -->
      <a routerLink="/teacher/dashboard" routerLinkActive="active" class="sidebar-item">
        <span class="sidebar-icon">ğŸ“Š</span>
        <span class="sidebar-text">Dashboard</span>
      </a>

      <!-- Exam Management -->
      <div class="sidebar-menu" *ngIf="canAccessModule('exams')">
        <div class="sidebar-menu-header" (click)="toggleMenu('examManagement')">
          <span class="sidebar-icon">ğŸ“</span>
          <span class="sidebar-text">Exam Management</span>
          <span class="sidebar-arrow" [class.expanded]="isMenuExpanded('examManagement')">â–¼</span>
        </div>
        <div class="sidebar-submenu" [class.expanded]="isMenuExpanded('examManagement')">
          <a routerLink="/exams" routerLinkActive="active" class="sidebar-subitem">
            <span class="sidebar-text">Marks Capturing</span>
          </a>
          <a routerLink="/mark-sheet" routerLinkActive="active" class="sidebar-subitem">
            <span class="sidebar-text">Mark Sheets</span>
          </a>
        </div>
      </div>

      <!-- Record Book -->
      <a routerLink="/teacher/record-book" routerLinkActive="active" class="sidebar-item" *ngIf="canAccessModule('recordBook')">
        <span class="sidebar-icon">ğŸ“š</span>
        <span class="sidebar-text">Record Book</span>
      </a>

      <!-- Rankings -->
      <a routerLink="/rankings" routerLinkActive="active" class="sidebar-item" *ngIf="canAccessModule('rankings')">
        <span class="sidebar-icon">ğŸ†</span>
        <span class="sidebar-text">Rankings</span>
      </a>

      <!-- Report Cards -->
      <a routerLink="/report-cards" routerLinkActive="active" class="sidebar-item" *ngIf="canAccessModule('reportCards')">
        <span class="sidebar-icon">ğŸ“Š</span>
        <span class="sidebar-text">Report Cards</span>
      </a>

      <!-- Students -->
      <a routerLink="/students" routerLinkActive="active" class="sidebar-item" *ngIf="canAccessModule('students')">
        <span class="sidebar-icon">ğŸ‘¥</span>
        <span class="sidebar-text">Students</span>
      </a>

      <!-- Classes -->
      <a routerLink="/classes" routerLinkActive="active" class="sidebar-item" *ngIf="canAccessModule('classes')">
        <span class="sidebar-icon">ğŸ«</span>
        <span class="sidebar-text">Classes</span>
      </a>

      <!-- Subjects -->
      <a routerLink="/subjects" routerLinkActive="active" class="sidebar-item" *ngIf="canAccessModule('subjects')">
        <span class="sidebar-icon">ğŸ“š</span>
        <span class="sidebar-text">Subjects</span>
      </a>

      <!-- Attendance -->
      <a routerLink="/attendance" routerLinkActive="active" class="sidebar-item" *ngIf="canAccessModule('attendance')">
        <span class="sidebar-icon">âœ…</span>
        <span class="sidebar-text">Attendance</span>
      </a>

      <!-- Finance -->
      <a routerLink="/invoices" routerLinkActive="active" class="sidebar-item" *ngIf="canAccessModule('finance')">
        <span class="sidebar-icon">ğŸ’°</span>
        <span class="sidebar-text">Finance</span>
      </a>

      <!-- Settings -->
      <a routerLink="/settings" routerLinkActive="active" class="sidebar-item" *ngIf="canAccessModule('settings')">
        <span class="sidebar-icon">âš™ï¸</span>
        <span class="sidebar-text">Settings</span>
      </a>

      <!-- Logout -->
      <div class="menu-section logout-section">
        <ul class="menu-list">
          <li><a (click)="logout()" style="cursor: pointer; color: #dc3545;">
            <span class="menu-icon">ğŸšª</span> Logout
          </a></li>
        </ul>
      </div>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <div class="dashboard-header">
      <div>
        <h1>Teacher Dashboard</h1>
        <p class="welcome-text">
          Welcome back, <strong>{{ teacherName || 'Teacher' }}</strong>!
        </p>
      </div>
      <div class="header-actions">
        <button class="btn btn-info" (click)="manageAccount()">ğŸ‘¤ Manage Account</button>
      </div>
    </div>

    <div class="alert alert-error" *ngIf="error" style="color: red; font-weight: bold;">{{ error }}</div>

    <div *ngIf="loading" class="loading-message">Loading classes...</div>

    <div *ngIf="!loading && teacherClasses.length === 0" class="empty-state">
      <div class="empty-state-content">
        <h2>No Classes Assigned</h2>
        <p>You haven't been assigned to any classes yet. Please contact the administrator to get assigned to classes.</p>
      </div>
    </div>

    <!-- Available Modules Section -->
    <div *ngIf="availableModules.length > 0" class="modules-section">
      <div class="section-header">
        <h2>Available Modules</h2>
        <span class="module-count-badge">{{ availableModules.length }} module{{ availableModules.length !== 1 ? 's' : '' }}</span>
      </div>
      <div class="modules-grid">
        <div *ngFor="let module of availableModules" class="module-card" (click)="navigateToModule(module)">
          <div class="module-header">
            <span class="module-icon">{{ module.icon }}</span>
            <h3>{{ module.name }}</h3>
          </div>
          <div class="module-description">
            <p>{{ module.description }}</p>
          </div>
          <div class="module-action">
            <button class="btn btn-primary btn-full">
              Open {{ module.name }}
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Assigned Classes Section -->
    <div *ngIf="!loading && teacherClasses.length > 0" class="classes-section">
      <div class="section-header">
        <h2>Your Assigned Classes</h2>
        <span class="class-count-badge">{{ teacherClasses.length }} class{{ teacherClasses.length !== 1 ? 'es' : '' }}</span>
      </div>
      <div class="classes-dropdown-section">
        <div class="dropdown-container">
          <label for="class-select" class="dropdown-label">
            <span class="label-icon">ğŸ«</span>
            Select a Class:
          </label>
          <select 
            id="class-select"
            class="class-dropdown" 
            [(ngModel)]="selectedClassId"
            (change)="onClassSelected()">
            <option value="">-- Select a Class --</option>
            <option *ngFor="let classItem of teacherClasses" [value]="classItem.id">
              {{ classItem.name }} ({{ classItem.form || 'N/A' }})
            </option>
          </select>
          <button 
            class="btn btn-primary btn-open-record" 
            (click)="openRecordBook()"
            [disabled]="!selectedClassId">
            <span class="btn-icon">ğŸ“š</span>
            <span>Open Record Book</span>
          </button>
        </div>
      </div>
    </div>
  </main>
</div>

